########################################################################################################################################################################################################
########################################################################################################################################################################################################
########################################################################################################################################################################################################
##########                                                  
##########           © Aimsun ®
##########                                                  
########################################################################################################################################################################################################
########################################################################################################################################################################################################
########################################################################################################################################################################################################
# Disclaimer of Warranty: TO THE EXTENT PERMITTED BY APPLICABLE LAW THE AIMSUN
# SCRIPTS, INCLUDING BUT NOT LIMITED TO ALL DATA, TOOLS AND CALCULATIONS THEREIN
# ARE PROVIDED "AS IS" AND WITHOUT EXPRESS OR IMPLIED WARRANTY OF ANY KIND BY
# EITHER Aimsun OR ANYONE ELSE WHO HAS BEEN INVOLVED IN THE CREATION, PRODUCTION OR
# DELIVERY OF THE AIMSUN SCRIPTS, INCLUDING BUT NOT LIMITED TO ANY EXPRESS OR
# IMPLIED WARRANTY OF MERCHANTABILITY, ACCURACY, QUIET ENJOYMENT,
# NONINFRINGEMENT OR FITNESS FOR A PARTICULAR PURPOSE. NO COVENANTS, WARRANTIES
# OR INDEMNITIES OF ANY KIND ARE GRANTED BY Aimsun TO YOU THE USER. SHOULD THE
# PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,
# REPAIR OR CORRECTION.
########################################################################################################################################################################################################
########################################################################################################################################################################################################
########################################################################################################################################################################################################

'''
@Project: 

@author: USER
@created: 18 Dec 2019
@version: AIMSUNVERSION;
@location: FILE

@modified: 

Purpose:


Pre-conditions:
1)

@tags: TAGS

'''
########################################################################################################################################################################################################
##########                                                        
##########    Global User's inputs   
##########                                              
########################################################################################################################################################################################################

IS_DEBUG = True

BAT_NAME = "runthem.bat"

DO_PARALLEL = False

########################################################################################################################################################################################################
##########                                       
##########    Define Types and initialise variables 
##########                                             
########################################################################################################################################################################################################
# Types - 

import sys
import os
########################################################################################################################################################################################################
##########                        
##########    Define Global Functions
##########                               
########################################################################################################################################################################################################

            
########################################################################################################################################################################################################
##########                        
##########    Start main body -
##########                               
########################################################################################################################################################################################################

def main():

	setReplicationIds = set()

	for item in selection:
		#if item.isA(model.getType("GKReplication")):
		setReplicationIds.add(item.getId())

		#start "C:\Users\xxxxxx\Desktop\xxxx\sqlites"
	
	if len(setReplicationIds)==0:
		print( "no replications selected. fail")
		return

	aimsunPath = str( QFileInfo( sys.executable ).absolutePath() )
	print (aimsunPath)
	modelPath = str( QFileInfo( model.getDocumentFileName() ).filePath() )
	print (modelPath)
	execmd = aimsunPath + '/aconsole.exe'

	path = os.path.dirname( str( model.getDocumentFileName() ) )

	f = open(path + "/" +  BAT_NAME,'w')

	for repId in sorted(setReplicationIds):
		args = []
		if DO_PARALLEL:
			args += ['start']
		args += ["\"" + execmd + "\"", '-log', '-v', '-project', "\"" + modelPath + "\"", '-cmd', 'execute',  '-target', str( repId ) ]
		f.write(" ".join(args) + "\n")

	f.close()



	return

main()

print( "Done")